-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | For signing AWS CloudFront HTTP URL requests
--   
--   Provides functions for reading in the signing keys from file and
--   making up time-limited, signed URLS for accessing AWS
--   CloudFront-hosted files.
@package aws-cloudfront-signer
@version 1.1.0.0

module Aws.CloudFront.Signer

-- | The input and output URLs.
type URL = String

-- | The CloudFront key pair identifier.
type KeyID = String

-- | A JSON CloudFront policy.
type JSONPOlicy = String

-- | A CloudFront siging key has an identifier and an RSA private key.
data CloudFrontSigningKey
CloudFrontSigningKey :: KeyID -> PrivateKey -> CloudFrontSigningKey
cfk_key_id :: CloudFrontSigningKey -> KeyID
cfk_key :: CloudFrontSigningKey -> PrivateKey

-- | A CloudFront policy must identify the resource being accessed and the
--   expiry time; a starting time and IPv4 address may also be specified.
data CloudFrontPolicy
CloudFrontPolicy :: URL -> UTCTime -> Maybe UTCTime -> Maybe String -> CloudFrontPolicy
cfp_Resource :: CloudFrontPolicy -> URL
cfp_DateLessThan :: CloudFrontPolicy -> UTCTime
cfp_DateGreaterThan :: CloudFrontPolicy -> Maybe UTCTime
cfp_IpAddress :: CloudFrontPolicy -> Maybe String

-- | RSA private keys can only be read from DER file for now (the OpenSSL
--   tools can be used to convert from PEM:
--   
--   openssl rsa -in input.pem -inform PEM -out output.der -outform DER
readCloudFrontSigningKeyFromDER :: KeyID -> FilePath -> IO CloudFrontSigningKey

-- | If you have the DER ByteString then you can construct a private key
--   functionally.
parseRSAPrivateKeyDER :: ByteString -> Either String PrivateKey

-- | In most cases only a time-limited, signed URL is needed, in which case
--   a canned policy can be used; URLs signed with a canned policy are
--   shorter than those signed with a custom policy.
signCannedPolicyURL :: CloudFrontSigningKey -> UTCTime -> URL -> URL

-- | Signing a URL with a custom policy allows a start time to be specified
--   and the IP address of the recipient(s) to be specified.
signCustomPolicyURL :: CloudFrontSigningKey -> CloudFrontPolicy -> URL

-- | The URL can also be signed with the custom policy in JSON format. (See
--   the CloudFront documentation for details.)
signCustomPolicyURL_ :: CloudFrontSigningKey -> JSONPOlicy -> URL -> URL

-- | The JSON canned policy can be generated from the expiry time and the
--   URL of the distributed resource.
cannedPolicy :: UTCTime -> URL -> JSONPOlicy

-- | JSON custom policies provide more flexibility (allowing start times
--   and recipient IP addresses to be specified) but generate longer signed
--   URLs.
customPolicy :: CloudFrontPolicy -> JSONPOlicy

-- | CloudFront uses Unix Epoch time (number of seconds since 1970, UTC) to
--   specify UTC.
unixTime :: UTCTime -> String
instance Typeable CloudFrontSigningKey
instance Typeable CloudFrontPolicy
instance Eq CloudFrontSigningKey
instance Read CloudFrontSigningKey
instance Show CloudFrontSigningKey
instance Read CloudFrontPolicy
instance Show CloudFrontPolicy
