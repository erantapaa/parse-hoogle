-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | Fay integration for Snap with request- and pre-compilation.
--   
@package snaplet-fay
@version 0.3.3.12

module Snap.Snaplet.Fay.Internal

-- | Configuration
data Fay
Fay :: FilePath -> Bool -> CompileMode -> Bool -> [FilePath] -> [String] -> Fay
snapletFilePath :: Fay -> FilePath
verbose :: Fay -> Bool
compileMode :: Fay -> CompileMode
prettyPrint :: Fay -> Bool
_includeDirs :: Fay -> [FilePath]
packages :: Fay -> [String]

-- | Location of .hs files
srcDir :: Fay -> FilePath

-- | Location of .js files
destDir :: Fay -> FilePath

-- | Where to check for imports
includeDirs :: Fay -> [FilePath]

-- | Compile on every request or when Snap starts.
data CompileMode
Development :: CompileMode
Production :: CompileMode

-- | Used by callers of compileFile to get the status of compilation.
data CompileResult
Success :: String -> CompileResult
NotFound :: CompileResult
Error :: String -> CompileResult

-- | Compile a single file, print errors if they occur and return the |
--   compiled source if successful.
compileFile :: Fay -> FilePath -> IO CompileResult

-- | Checks the specified source folder and compiles all new and modified
--   scripts. Also removes any js files whose Fay source has been deleted.
--   All files are checked each request.
compileAll :: Fay -> IO ()

-- | Helpers
--   
--   Checks if a string ends with another string.
hasSuffix :: String -> String -> Bool

-- | Extract the filename from a filepath.
filename :: FilePath -> FilePath

-- | Convert a JS filename to a Haskell filename.
toHsName :: String -> String

-- | Gets the filepath of the files with the given file extension in a
--   folder.
extFiles :: String -> FilePath -> IO [FilePath]

-- | Convert from the location of a js file to the location of its source
--   hs file.
jsPath :: Fay -> FilePath -> FilePath

-- | Convert from the location of a hs file to the location of the
--   destination js file.
hsPath :: Fay -> FilePath -> FilePath

-- | Relative path to a js file.
jsRelativePath :: FilePath -> FilePath

-- | Relative path to a hs file.
hsRelativePath :: FilePath -> FilePath

-- | Print log messages when the verbose flag is set
verbosePut :: Fay -> String -> IO ()
instance Eq CompileMode
instance Show CompileMode
instance Show Fay

module Snap.Snaplet.Fay

-- | Configuration
data Fay

-- | Snaplet initialization
initFay :: SnapletInit b Fay

-- | Serves the compiled Fay scripts using the chosen compile mode.
fayServe :: Handler b Fay ()

-- | Send and receive JSON. | Automatically decodes a JSON request into a
--   Fay record which is | passed to <tt>g</tt>. The handler <tt>g</tt>
--   should then return a Fay record (of | a possibly separate type) which
--   is encoded and passed back as a | JSON response. | If you only want to
--   send JSON and handle input manually, use toFayax. | If you want to
--   receive JSON and handle the response manually, use fromFayax
fayax :: (Data f1, Read f1, Data f2) => (f1 -> Handler h1 h2 f2) -> Handler h1 h2 ()

-- | fayax only sending JSON.
toFayax :: Data f2 => Handler h1 h2 f2 -> Handler h1 h2 ()

-- | fayax only recieving JSON.
fromFayax :: (Data f1, Read f1) => (f1 -> Handler h1 h2 ()) -> Handler h1 h2 ()
