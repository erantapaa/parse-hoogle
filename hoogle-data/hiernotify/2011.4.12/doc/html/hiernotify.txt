-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | Notification library for a filesystem hierarchy.
--   
--   Notification library for a filesystem hierarchy.
@package hiernotify
@version 2011.4.12

module System.Hiernotify.Polling

-- | make a polling notifier , given an interval in seconds
mkPollNotifier :: Int -> Configuration -> IO Notifier

-- | Configuration for notifiers. Minimal configuration to build a
--   notifier.
data Configuration
Configuration :: FilePath -> Int64 -> (FilePath -> Bool) -> Configuration

-- | directory at the top of the hierarchy under control
top :: Configuration -> FilePath

-- | minimum time lapse in seconds where nothing changes before a
--   difference is released
silence :: Configuration -> Int64

-- | filter for file paths, positive must be included
select :: Configuration -> FilePath -> Bool

-- | Difference datatype containing a difference as three sets of paths.
--   This datatype is the core content of a notification of changes in a
--   hierarchy.
data DifferenceP a
DifferenceP :: [a] -> [a] -> [a] -> DifferenceP a

-- | Files appeared
created :: DifferenceP a -> [a]

-- | Files disappeared
deleted :: DifferenceP a -> [a]

-- | Files modified
modified :: DifferenceP a -> [a]
type Difference = DifferenceP FilePath

-- | Abstract notifiers. A Notifier is an object controlling a hierarchy.
--   
--   Its difference method will block until a Difference is available and
--   at least a time of peace has elapsed.
--   
--   Reading a difference must result internally in deleting the difference
--   and updating the list of paths. The list of paths read together with
--   the difference is always the list of paths to which the difference
--   will be applied.
data Notifier
Notifier :: IO (Difference, [FilePath]) -> IO () -> Notifier

-- | block until next difference
difference :: Notifier -> IO (Difference, [FilePath])

-- | stop the notification daemon
stop :: Notifier -> IO ()
