-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | A deployment library for Haskell applications
--   
@package hapistrano
@version 0.2.0.2


-- | A module for easily creating reliable deploy processes for Haskell
--   applications.
module System.Hapistrano

-- | Config stuff that will be replaced by config file reading
data Config
Config :: String -> String -> String -> ReleaseFormat -> Maybe String -> Maybe FilePath -> Maybe String -> Config

-- | The root of the deploy target on the remote host
deployPath :: Config -> String

-- | The remote git repo
repository :: Config -> String

-- | A SHA1 or branch to release
revision :: Config -> String
releaseFormat :: Config -> ReleaseFormat

-- | The target host for the deploy, or Nothing to indicate that operations
--   should be done directly in the local deployPath without going over SSH
host :: Config -> Maybe String

-- | The local path to a file that should be executed on the remote server
--   to build the application.
buildScript :: Config -> Maybe FilePath

-- | Optional command to restart the server after a successful deploy
restartCommand :: Config -> Maybe String

-- | Switches the current symlink to point to the release specified in the
--   configuration. Maybe used in either deploy or rollback cases.
activateRelease :: Release -> Hapistrano String

-- | Returns the full path to the current symlink.
currentPath :: FilePath -> FilePath

-- | Default method to run on deploy success.
defaultSuccessHandler :: a -> ReaderT Config IO ()

-- | Default method to run on deploy failure. Emits a failure message and
--   exits with a status code of 1.
defaultErrorHandler :: FailureResult -> ReaderT Config IO ()
directoryExists :: Maybe String -> FilePath -> IO Bool

-- | Returns a Bool indicating if the given String is in the proper release
--   format.
isReleaseString :: ReleaseFormat -> String -> Bool

-- | Take the release timestamp from the end of a filepath.
pathToRelease :: FilePath -> Release

-- | Does basic project setup for a project, including making sure some
--   directories exist, and pushing a new release directory with the SHA1
--   or branch specified in the configuration.
pushRelease :: Hapistrano Release

-- | Trims any newlines from the given String
--   
--   Returns the FilePath pointed to by the current symlink.
readCurrentLink :: Hapistrano FilePath

-- | Runs a command to restart a server if a command is provided.
restartServerCommand :: Hapistrano String

-- | Activates the previous detected release.
rollback :: Hapistrano String

-- | Runs the deploy, along with an optional success or failure function.
runRC :: ((Int, String) -> ReaderT Config IO a) -> (a -> ReaderT Config IO a) -> Config -> Hapistrano a -> IO a

-- | Runs a build script if one is provided.
runBuild :: Release -> Hapistrano Release
