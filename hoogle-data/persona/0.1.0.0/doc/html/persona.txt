-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | Persona (BrowserID) library
--   
--   Persona (BrowesrID) library
@package persona
@version 0.1.0.0


-- | Mozilla Persona (formerly BrowserID) types.
module Crypto.Persona

-- | Newtype of URI resticted to relative URIs.
data RelativeURI

-- | Construct a <a>RelativeURI</a>
parseRelativeURI :: String -> Maybe RelativeURI

-- | <i>Delegated support document</i>
newtype DelegatedSupportDocument
DelegatedSupportDocument :: String -> DelegatedSupportDocument
authority :: Iso' DelegatedSupportDocument String

-- | Basic <i>support document</i>.
--   
--   See
--   https:/<i>developer.mozilla.org</i>en-US<i>Persona</i>.well-known-browserid.
data SupportDocument
publicKey :: Lens' SupportDocument JWK'
authentication :: Lens' SupportDocument RelativeURI
provisioning :: Lens' SupportDocument RelativeURI

-- | Construct a <a>SupportDocument</a>
--   
--   The smart constructor is needed to ensure that any private key
--   material is stripped from the key. Although RSA keys always have
--   public material the result is a 'Maybe SupportDocument' to enable a
--   move to the JSON Web Key (JWK) format.
supportDocument :: JWK' -> RelativeURI -> RelativeURI -> Maybe SupportDocument

-- | Persona identity principal
--   
--   TODO: actually restrict to email addresses or hostnames.
data Principal
EmailPrincipal :: Text -> Principal
HostPrincipal :: Text -> Principal

-- | Create an identity assertion.
certify :: CPRG g => g -> JWK' -> StringOrURI -> UTCTime -> Integer -> Value -> Principal -> (Either Error JWT, g)

-- | URI to official provisioning JavaScript.
provisioningApiJsUrl :: String

-- | URI to official authentication JavaScript.
authenticationApiJsUrl :: String
instance ToJSON Principal
instance FromJSON Principal
instance ToJSON DelegatedSupportDocument
instance FromJSON DelegatedSupportDocument
instance Eq DelegatedSupportDocument
instance Show DelegatedSupportDocument
instance ToJSON SupportDocument
instance FromJSON SupportDocument
instance Eq RelativeURI
instance ToJSON RelativeURI
instance FromJSON RelativeURI
instance Show RelativeURI
